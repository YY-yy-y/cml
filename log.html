<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–∞ –¥–ª—è –º–æ–µ–π –ª—é–±–∏–º–∏ ‚ù§Ô∏è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–π —à—Ä–∏—Ñ—Ç –¥–ª—è —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #F1F5F9; /* –ë–æ–ª–µ–µ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ñ–æ–Ω */
        }
        .font-pacifico {
            font-family: 'Pacifico', cursive;
        }
        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
        .fade-in {
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏ –¥–ª—è —Å–µ—Ä–¥–µ—á–∫–∞ */
        .pulse {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç—ã */
        #map {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 350px; /* –ù–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–∏–º –≤—ã—Å–æ—Ç—É –¥–ª—è –∫–∞—Ä—Ç—ã */
            background-color: #E0F2FE; /* –ì–æ–ª—É–±–æ–π —Ñ–æ–Ω, –∫–∞–∫ –≤–æ–¥–∞ –∏–ª–∏ –Ω–µ–±–æ */
            background-image: url('https://www.transparenttextures.com/patterns/light-paper-fibers.png');
            border: 2px solid #38BDF8;
            border-radius: 1rem;
            margin: 1rem auto;
            overflow: hidden;
        }
        .location {
            position: absolute;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .location:hover {
            transform: scale(1.1);
        }
        .location-icon {
            width: 50px;
            height: 50px;
            background-color: #fca5a5;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            border: 3px solid white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .location-name {
            margin-top: 0.5rem;
            font-size: 0.8rem;
            font-weight: bold;
            color: #1E3A8A;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 2px 8px;
            border-radius: 99px;
        }
        #truck {
            position: absolute;
            z-index: 5;
            font-size: 2.5rem;
            transition: all 1.5s cubic-bezier(0.45, 0, 0.55, 1); /* –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        #map-roads {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
    </style>
</head>
<body class="bg-slate-100 text-gray-800 flex items-center justify-center min-h-screen p-4">

    <div id="game-container" class="w-full max-w-md mx-auto bg-white rounded-2xl shadow-xl p-6 text-center">

        <!-- –ù–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="start-screen" class="fade-in">
            <h1 class="font-pacifico text-4xl text-sky-500 mb-2">–ü–†–ê–í–ò–õ–¨–ù–ê–Ø –õ–û–ì–ò–°–¢–ò–ö–ê</h1>
            <p class="text-lg mb-4">–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –ª—é–±–µ–º–µ –ö–∞–º–∏–ª–ª—ã!</p>
            <div class="text-5xl mb-6 pulse">‚ù§Ô∏è</div>
            <p class="mb-6">–ì–æ—Ç–æ–≤–∞ –ª—é–±–∏–º–∏?</p>
            <button id="start-button" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-transform transform hover:scale-105">
                –ù–∞—á–∞—Ç—å!
            </button>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
        <div id="game-screen" class="hidden">
            <h2 id="task-title" class="font-pacifico text-3xl text-sky-500 mb-2">–ù–æ–≤—ã–π</h2>
            <p id="task-description" class="mb-4 text-lg">–ù—É–∂–Ω–æ –∑–∞–±—Ä–∞—Ç—å –≥—Ä—É–∑ —Å–æ "–°–∫–ª–∞–¥–∞ –ß—É–≤—Å—Ç–≤"</p>

            <div id="map">
                <svg id="map-roads" preserveAspectRatio="none" viewBox="0 0 500 350">
                    <!-- –î–æ—Ä–æ–≥–∏ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ -->
                    <path d="M 75 175 C 150 50, 250 50, 250 70 S 300 250, 350 245 C 400 240, 400 175, 450 175" stroke="#a0aec0" stroke-width="6" fill="none" stroke-linecap="round"/>
                    <path d="M 75 175 C 150 300, 250 300, 250 280 S 300 100, 350 105 C 400 110, 400 175, 450 175" stroke="#a0aec0" stroke-width="6" fill="none" stroke-linecap="round"/>
                </svg>
                <!-- –õ–æ–∫–∞—Ü–∏–∏ –∏ –≥—Ä—É–∑–æ–≤–∏–∫ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>

            <div id="message-box" class="mt-4 p-4 bg-sky-100 border border-sky-200 rounded-xl min-h-[100px] flex items-center justify-center">
                <p id="message-text" class="text-sky-700 font-medium text-lg"></p>
            </div>
        </div>

        <!-- –ö–æ–Ω–µ—á–Ω—ã–π —ç–∫—Ä–∞–Ω (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
        <div id="end-screen" class="hidden fade-in">
            <h1 class="font-pacifico text-4xl text-sky-500 mb-2">–ú–∞—Ä—à—Ä—É—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!</h1>
            <div class="text-6xl my-6">üéâüíñüéâ</div>
            <p class="text-xl mb-4">–¢—ã –∏–¥–µ–∞–ª—å–Ω–æ —Å–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–∞ –¥–æ—Å—Ç–∞–≤–∫—É!</p>
            <p class="text-2xl font-bold text-sky-600 mb-6">–Ø —Ç–µ–±—è –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –ª—é–±–ª—é –∞—Å–∞–ª–∏–º!</p>
            <button id="restart-button" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-transform transform hover:scale-105">
                –°–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –µ—â–µ —Ä–∞–∑
            </button>
        </div>

    </div>

    <script>
        // --- –≠–ª–µ–º–µ–Ω—Ç—ã DOM ---
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const endScreen = document.getElementById('end-screen');
        const startButton = document.getElementById('start-button');
        const restartButton = document.getElementById('restart-button');
        const map = document.getElementById('map');
        const taskTitle = document.getElementById('task-title');
        const taskDescription = document.getElementById('task-description');
        const messageText = document.getElementById('message-text');
        
        // --- –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –≥—Ä—É–∑–æ–≤–∏–∫–∞ ---
        let truck = null;

        // --- –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ ---
        const locations = {
            start: { name: '–°–∫–ª–∞–¥ —á—É–≤—Å—Ç–≤ –Æ—Å—É—Ñ–±–µ–∫–∞', x: 10, y: 45, icon: 'üíñ', el: null },
            point1: { name: '–î—É—à–∞ –Æ—Å—É—Ñ–±–µ–∫–∞', x: 45, y: 15, icon: '‚ú®', el: null },
            point2: { name: '–ú–µ—Å—Ç–æ –¥–ª—è –õ—é–±–µ–º–µ', x: 60, y: 75, icon: 'üå∏', el: null },
            end: { name: '–°–µ—Ä–¥—Ü–µ –Æ—Å—É—Ñ–±–µ–∫–∞', x: 70, y: 45, icon: 'üíù', el: null }
        };

        const packages = [
            { 
                name: '–õ—é–±–∏–º–∏', 
                pickupMessage: '–í–æ–¥–∏—Ç–µ–ª—å –ø–æ–∑–≤–æ–Ω–∏–ª —Ç–µ–±–µ: –¢—ã —Å–∞–º—ã–π –∫—Ä–∞—Å–∏–≤—ã–π —á–µ–ª–æ–≤–µ–∫ –≤–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π!',
                deliveryMessage: '–¢—ã —Å–∞–º—ã–π —Ü–µ–Ω–Ω—ã–π –¥–ª—è –º–µ–Ω—è —á–µ–ª–æ–≤–µ–∫!'
            },
            { 
                name: '–õ—é–±–µ–º–µ', 
                pickupMessage: '–Ø —Ç–µ–±—è –æ–±–æ–∂–∞—é –≤—Å–µ–º —Å–≤–æ–∏–º —Å–µ—Ä–¥—Ü–µ–º',
                deliveryMessage: '–î–æ—Å—Ç–∞–≤–∫–∞ –º–æ–µ–π –ª—é–±–≤–∏ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!'
            },
            { 
                name: '–ê—Å–∞–ª–∏–º', 
                pickupMessage: '–¢—ã –ª—É—á—à–∏–π —á–µ–ª–æ–≤–µ–∫ —Å –Ω–µ–æ–±—ã—á–∞–π–Ω–æ–π –≤–Ω–µ—à–Ω–æ—Å—Ç—å—é –∏ –≤—ã—Å–æ–∫–∏–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º.',
                deliveryMessage: '–õ–Æ–ë–õ–Æ –¶–ï–õ–£–Æ–Æ–Æ–Æ'
            },
            {
                name: '–ö–∞–º–µ–ª–ª–∞',
                pickupMessage: '–í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞—é –Ω–∞–¥ —Å–æ–±–æ–π —Å –æ–¥–Ω–æ–π —Ü–µ–ª—å—é - —Å–¥–µ–ª–∞—Ç—å —Ç–µ–±—è —Å—á–∞—Å—Ç–ª–∏–≤–æ–π',
                deliveryMessage: '–¢—ã –≥–µ–Ω–∏–π –ª–æ–≥–∏—Å—Ç–∏–∫–∏!'
            }
        ];

        // --- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã ---
        let currentPackageIndex = 0;
        let hasPackage = false;
        let truckLocationKey = 'start';

        // --- –§—É–Ω–∫—Ü–∏–∏ ---

        /**
         * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º –±–ª–æ–∫–µ
         * @param {string} text - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
         * @param {boolean} isAction - –≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ-–¥–µ–π—Å—Ç–≤–∏–µ –∏–ª–∏ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç
         */
        function showMessage(text, isAction = false) {
            const msgBox = messageText.parentElement;
            msgBox.className = 'mt-4 p-4 rounded-xl min-h-[100px] flex items-center justify-center transition-all duration-300';
            if (isAction) {
                msgBox.classList.add('bg-sky-100', 'border', 'border-sky-200');
                messageText.className = 'text-sky-700 font-medium text-lg';
            } else {
                msgBox.classList.add('bg-emerald-100', 'border', 'border-emerald-200');
                messageText.className = 'text-emerald-700 font-medium text-lg';
            }
            messageText.textContent = text;
            messageText.classList.remove('fade-in');
            void messageText.offsetWidth; // –¢—Ä—é–∫ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
            messageText.classList.add('fade-in');
        }

        /**
         * –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –≥—Ä—É–∑–æ–≤–∏–∫ –≤ –Ω–æ–≤—É—é –ª–æ–∫–∞—Ü–∏—é
         * @param {string} locationKey - –ö–ª—é—á –ª–æ–∫–∞—Ü–∏–∏ –∏–∑ –æ–±—ä–µ–∫—Ç–∞ locations
         */
        function moveTruck(locationKey) {
            const targetLocation = locations[locationKey];
            if (truck) {
                truck.style.left = `calc(${targetLocation.x}% - 20px)`;
                truck.style.top = `calc(${targetLocation.y}% - 25px)`;
            }
            truckLocationKey = locationKey;

            // –î–µ–ª–∞–µ–º –∏–∫–æ–Ω–∫—É –∞–∫—Ç–∏–≤–Ω–æ–π –ª–æ–∫–∞—Ü–∏–∏ —è—Ä—á–µ
            Object.values(locations).forEach(loc => {
                if (loc.el) {
                    loc.el.querySelector('.location-icon').style.borderColor = 'white';
                    loc.el.querySelector('.location-icon').style.backgroundColor = '#fca5a5';
                }
            });
            if (targetLocation.el) {
                 targetLocation.el.querySelector('.location-icon').style.borderColor = '#0284C7'; // –Ø—Ä–∫–æ-—Å–∏–Ω–∏–π
                 targetLocation.el.querySelector('.location-icon').style.backgroundColor = '#F87171';
            }
        }
        
        /**
         * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –ª–æ–∫–∞—Ü–∏–∏
         * @param {string} clickedKey - –ö–ª—é—á –∫–ª–∏–∫–Ω—É—Ç–æ–π –ª–æ–∫–∞—Ü–∏–∏
         */
        function onLocationClick(clickedKey) {
            moveTruck(clickedKey);
            const pkg = packages[currentPackageIndex];

            // –õ–æ–≥–∏–∫–∞ –ø–æ–¥–±–æ—Ä–∞ –≥—Ä—É–∑–∞
            if (clickedKey === 'start' && !hasPackage) {
                hasPackage = true;
                taskTitle.textContent = '–í–æ–¥–∏—Ç–µ–ª—å –≤ –ø—É—Ç–∏!';
                taskDescription.textContent = `–ù–∞–ø—Ä–∞–≤—å –µ–≥–æ –≤ "${locations.end.name}"`;
                showMessage(pkg.pickupMessage);
            } 
            // –õ–æ–≥–∏–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –≥—Ä—É–∑–∞
            else if (clickedKey === 'end' && hasPackage) {
                showMessage(pkg.deliveryMessage, false);
                
                currentPackageIndex++;
                hasPackage = false;

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–æ–Ω–µ—Ü –ª–∏ –∏–≥—Ä—ã
                if (currentPackageIndex >= packages.length) {
                    setTimeout(endGame, 2500);
                } else {
                    const nextPkg = packages[currentPackageIndex];
                    taskTitle.textContent = '–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞!';
                    taskDescription.textContent = `–û—Ç–ø—Ä–∞–≤—å –≤–æ–¥–∏—Ç–µ–ª—è –∑–∞ –≥—Ä—É–∑–æ–º "${nextPkg.name}"`;
                }
            }
            // –ö–ª–∏–∫ –ø–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º —Ç–æ—á–∫–∞–º
            else if (clickedKey !== 'start' && clickedKey !== 'end') {
                 const compliments = [
                    "–°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è",
                    "–°–∞–º–∞—è —Ü–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª–µ–Ω–Ω–∞—è!",
                    "–°–∞–º–∞—è –ª—é–±–∏–º–∞—è.",
                    "–Ø –≤—Å–µ–≥–¥–∞ —Å —Ç–æ–±–æ–π, –ª—é–±–∏–º–∏."
                ];
                showMessage(compliments[Math.floor(Math.random() * compliments.length)]);
            }
        }

        /**
         * –†–∏—Å—É–µ—Ç –∫–∞—Ä—Ç—É —Å –ª–æ–∫–∞—Ü–∏—è–º–∏
         */
        function drawMap() {
            // –û—á–∏—â–∞–µ–º —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞—Ü–∏–∏, –æ—Å—Ç–∞–≤–ª—è—è –¥–æ—Ä–æ–≥–∏ –∏ –≥—Ä—É–∑–æ–≤–∏–∫
            map.querySelectorAll('.location').forEach(el => el.remove());

            // –°–æ–∑–¥–∞–µ–º –≥—Ä—É–∑–æ–≤–∏–∫, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
            if (!document.getElementById('truck')) {
                const truckEl = document.createElement('div');
                truckEl.id = 'truck';
                truckEl.textContent = 'üöö';
                map.appendChild(truckEl);
            }
            // –í–ê–ñ–ù–û: –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é truck
            truck = document.getElementById('truck');
            
            Object.keys(locations).forEach(key => {
                const loc = locations[key];
                const locationEl = document.createElement('div');
                locationEl.className = 'location';
                locationEl.style.left = `${loc.x}%`;
                locationEl.style.top = `${loc.y}%`;
                locationEl.innerHTML = `
                    <div class="location-icon">${loc.icon}</div>
                    <div class="location-name">${loc.name}</div>
                `;
                locationEl.addEventListener('click', () => onLocationClick(key));
                map.appendChild(locationEl);
                loc.el = locationEl; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç
            });
        }

        /**
         * –ù–∞—á–∏–Ω–∞–µ—Ç –∏–≥—Ä—É
         */
        function startGame() {
            currentPackageIndex = 0;
            hasPackage = false;
            truckLocationKey = 'start';
            
            startScreen.classList.add('hidden');
            endScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            gameScreen.classList.add('fade-in');

            drawMap();
            moveTruck('start');
            
            const firstPkg = packages[0];
            taskTitle.textContent = '–ü–µ—Ä–≤–∞—è –∑–∞–¥–∞—á–∞!';
            taskDescription.textContent = `–û—Ç–ø—Ä–∞–≤—å –≤–æ–¥–∏—Ç–µ–ª—è –∑–∞ –≥—Ä—É–∑–æ–º "${firstPkg.name} –Ω–∞ —Å–∫–ª–∞–¥"`;
            showMessage(`–ù–∞–∂–º–∏ –Ω–∞ "${locations.start.name}", —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–æ–¥–∏—Ç–µ–ª—è!`, true);
        }

        /**
         * –ó–∞–≤–µ—Ä—à–∞–µ—Ç –∏–≥—Ä—É
         */
        function endGame() {
            gameScreen.classList.add('hidden');
            endScreen.classList.remove('hidden');
        }

        // --- –ù–∞–≤–µ—à–∏–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è ---
        startButton.addEventListener('click', startGame);
        restartButton.addEventListener('click', startGame);

    </script>
</body>
</html>
